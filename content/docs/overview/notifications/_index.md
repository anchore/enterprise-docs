---
title: "Anchore Enterprise Notifications"
linkTitle: "Notifications"
weight: 4
---

### Glossary

**Event** An information packet generated by an Anchore Engine or Anchore Enterprise service to indicate some activity    
**Endpoint** External tool capable of receiving messages such as Slack, GitHub, Jira, MS Teams, email or webhook  
**Endpoint Configuration** Connection information of the endpoint used for sending messages  
**Selector** Criteria for selecting events to be notified

### Overview

Added in Anchore Enterprise v2.2

Anchore Enterprise includes Notifications service to alert external endpoints about Anchore Engine activity. Services that make up Anchore Engine and Anchore Enterprise generate events to record significant activity such as an update in the policy evaluation result or vulnerabilities for a tag, or an error analyzing an image. This service provides a mechanism to selectively notify events of interest to supported external endpoints. The actual notification itself depends on the endpoint - formatted message to Slack, email and MS Teams endpoints, tickets in GitHub and Jira endpoints and json payload to webhook endpoint   

### Installation

Anchore Enterprise Notifications is included with Anchore Enterprise, and is installed by default when deploying a trial quickstart with [Docker Compose]({{< ref "/docs/installation/docker_compose" >}}) or a production deployment [Kubernetes]({{< ref "/docs/installation/helm" >}}).

#### Configuration

The service loads configuration from the `notifications` section of the config.yaml. Following is a snippet of the configuration

```yaml
...
services:
  notifications:
    enabled: true
    require_auth: true
    endpoint_hostname: "<hostname>"
    listen: '0.0.0.0'
    port: 8228
    cycle_timers:
      notifications: 30
    # Set Anchore Enterprise UI base URL to receive UI links in notifications
    ui_url: "<enterprise-ui-url>"
    authorization_handler: external
    authorization_handler_config:
      endpoint: "<rbac-authorizer-endpoint>"
```

`cycle_timers -> notifications` controls how often the service checks for events in the system that need to be processed for notifications. Default is every 30 seconds

`ui_url` is used for constructing links to Enterprise UI pages in the notifications. Configure this property to the Enterprise UI's base URL. This URL should be accessible from the endpoint receiving the notification for the links to work correctly. If the value is unset, the notification message is still sent to the endpoint but it won't contain a clickable link to the Enterprise UI  

> NOTE: Any changes to the configuration requires a restart of the service for the updates to take effect

#### Permissions

TODO May be move this to API access
In an Anchore Enterprise RBAC enabled deployment the table below lists the required actions and containing roles     

| Description | Action | Roles |
| :---------- | :------| :---- |
| list all the available notification endpoints and their status | listNotificationEndpoints | Read Only, Read Write |
| list all available configurations for an endpoint | listNotificationEndpointConfigurations | Read Only, Read Write |
| get an endpoint configuration and associated selectors | getNotificationEndpointConfiguration | Read Only, Read Write |
| create an endpoint configuration and associated selectors | createNotificationEndpointConfiguration | Read Write |
| update an endpoint configuration and associated selectors | updateNotificationEndpointConfiguration | Read Write |
| delete an endpoint configuration and associated selectors | deletetNotificationEndpointConfiguration | Read Write |


### Concepts 
 
#### Endpoint Status

All endpoints in the Notifications service have a switch that can be toggled enabled/disabled. Endpoint status reflects state of this switch. By default status for all endpoints is enabled out of the box. Setting endpoint status to disabled stops all notifications from going out to any configurations of that specific endpoint. This is a system-wide setting that can only be updated by the admin account. It is read-only for remaining accounts 

#### Endpoint Configuration

Connection information such as URL, user credentials etc. for an endpoint. The service allows multiple configurations per endpoint. Endpoint configurations are scoped to the account   

#### Selector

Notifications services provides a mechanism to selectively choose events and route the corresponding notifications to a configured endpoint. This is achieved using a 'Selector' - a collection of filter criteria that process against an event and output a match or no-match result. If the result is a match, a notification message relating to the event is sent out. 

To understand this better, lets take a closer look at events

TODO available events api output here

##### Scope

Allowed values: `account`, `global`

All events are scoped to the account responsible for triggering the event. This includes even system generated events which are associated with a special account. `account` scope ensures that events associated with your account are matched. `global` scope matches all events in the system and is restricted only to admin account, non-admin account users cannot create `global` scoped selector     

##### Level 

Allowed values: `info`, `error`, `*`

`info` matches informational events such as policy evaluation or vulnerabilities update, image analysis completion etc. `error` matches failed attempts such as image analysis failure. `*` will match all events

##### Type

TODO explain the type field, this is the important one 

##### Resource type

Allowed values: `*`, `image_tag` 

`*` matches events associated with any resource and so on. TODO fill some words

##### Useful combinations

Here is a list 

| Notifications for | Scope | Level | Type | Resource Type |
| :---------------- | :---- | :---- | :--- | :------------ |
| Policy evaluation and vulnerabilities updates| `account` | `*` | `user.checks.*` | `*` |
| User errors  | `account` | `error` | `user.*` | `*` |
| User infos | `account` | `info` | `user.*` | `*` |
| Everything user related | `account` | `*` | `user.*` | `*` |  
| System errors | `account` | `error` | `system.*` | `*` |
| System infos | `account` | `info` | `system.*` | `*` |
| Everything system related | `account` | `*` | `system.*` | `*` |
| All | `account` | `*` | `*` | `*` |
| All for every account (admin account only) | `global` | `*` | `*` | `*` |


### See it in action

To learn more about configuring Notifications service in the Enterprise UI go to [Notifications]({{< ref "/docs/using/ui_usage/reports" >}})             

For using the API directly refer to <TODO API Access link here> 


