---
title: "Runtime Compliance API"
linkTitle: "Runtime Compliance"
weight: 4
---

### Overview

As of 3.1, Anchore has introduced a new runtime compliance API that users can utilize to gain insight into the security compliance of their runtime environments. Tools responsible for executing compliance checks on a running environment are the intended consumers of this general-purpose API, such as the Security Technical Implementation Guides (STIGs) that users can run on a kubernetes cluster using Anchore's [Remote Execution Manager (REM)]({{< ref "/docs/overview/runtime_compliance/compliance_check" >}}). These tools can upload the results of their execution to Anchore through this new compliance API, which allows users to leverage additional Anchore functionality like reporting and correlating the runtime environment to images analyzed by Anchore. This enables deeper understanding and insight into an image's lifecycle and the ongoing security of the runtime environments deploying them.


### Usage

The Compliance API can be found in the [Enterprise API swagger specification](/current/docs/using/api_usage/specs/enterprise_api_swagger.yaml). This API allows for the creation and retrieval of runtime compliance checks and any document reports provided in the creation calls.

The following is an example of the body of an API call to create a runtime compliance check using the Compliance API to be submitted as a multipart form to support file upload:
```json
{
  "check_type": "oscap", // type of compliance check to report
  "result": "pass", // overall result of compliance check
  "pod": "postgres-9.6", // k8s or kubernetes pod the compliance check was run against
  "namespace": "dev", // the namespace of the pod
  "image_tag": "9.6", // tag of the image that the pod is running
  "image_digest": "sha256:a435b8edc3bdb4d766818dc6ce22ca3a5e6a922d19ca7001afd1359d060500eb", // the digest of the running image
  "start_time": "2021-03-22T15:12:24.580054", // start time of the compliance run
  "end_time": "2021-03-22T16:02:24.580054" // end time of the compliance run
  "result_file": "path_to_file",
  "report_file": "path_to_file
}
```

Two fields are required for the creation of runtime compliance checks. The `type` field references the type of scan that generates the report. As of right now, the only supported option is `oscap`, which stands for OpenSCAP, but this is expected to grow with future releases. The other required field is `image_digest`, which represents the image used by the container that the runtime compliance check was run against. 

While not required, the `status` attribute is used to designate whether the given compliance check has passed or failed. There are several additional metadata fields provided to further contextualize the runtime check, such as the `pod` and `namespace` that the check was run against. 


One of the other key functionalities of this API is the ability to attach a `report_file` and a `result_file` to the created runtime compliance checks. This can be the direct output generated by the runtime tool itself, such as an OpenSCAP XML document. This allows for entire reports to be stored within Anchore using the [object storage]({{< ref "/docs/installation/storage/object_store" >}}), which allows for a number of options for how and where this data will be preserved.  

Once created, runtime compliance checks can be retrieved using the GET endpoint specified in the swagger spec. The corresponding result and report files can be retrieved by pulling the `file_ids` from a runtime compliance check and querying the endpoint for runtime compliance results using the specified `result_id`.

